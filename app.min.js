var App={modules:{},app:function(e){var e=e||{},t={},r={ready_modules:{}},n={debug:e.debug||!0,ready:!1,repeater_id:0,replace_delimiter:e.replace_delimiter||"__",name:e.name||"myApp"},o={prototypes_init:function(){Object.size=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;t>e;e++)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])}},error:function(e){throw new Error(e)},check:function(){if(n.ready===!1){if(1==n.debug)for(var e in t)("undefined"==typeof data.ready_modules[e]||0==data.ready_modules[e])&&console.log(e+" module not ready");o.error("Error. App not initialized properly.")}},execute:function(e){for(var r in t){var n=t[r],o=e.type;"function"==typeof n.functions[o]&&n.functions[o](e)}},repeater_create_object:function(e,t){var r=document.createElement(e.tagName);"undefined"!=typeof t["data-repeater_element_id"]&&(r.setAttribute("data-repeater_element_id",t["data-repeater_element_id"]),delete t["data-repeater_element_id"]),"undefined"!=typeof t["data-app"]&&(r.setAttribute("data-app",t["data-app"]),delete t["data-app"]);for(var a=0;a<e.children.length;a++){var i=e.children[a],d=o.repeater_create_object(i,t);r.appendChild(d)}if(0==e.childElementCount){var p=e.innerText;for(var l in t)p=o.replace_all(p,n.replace_delimiter+l+n.replace_delimiter,t[l]);r.innerText=p}for(var a=0;a<e.attributes.length;a++){var u=e.attributes[a],f=u.name;"id"==f&&o.error("Error: template can not contain ID attribute.");var c=t[f]||u.value;r.setAttribute(f,c)}return r},replace_all:function(e,t,r){for(;e.indexOf(t)>-1;)e=e.replace(t,r);return e},check_replace_params:function(e){var t=typeof e;if("number"==t||"string"==t)return!0;if("object"!=t)return!1;var r=!0;for(var n in e)if(r=r&&o.check_replace_params(e[n]),0==r)return r;return r}};this.init=function(){o.prototypes_init();var e=[];for(var r in t){var n=t[r];e.push(n)}e.forEach(function(e){e.init()})},this.notify=function(e){return("undefined"==typeof e||"undefined"==typeof e.type)&&o.error("Error. App.notify can't proccess this request."),"module_ready"==e.type?("undefined"==typeof e.data&&o.error("Error. App.notify can't proccess this request."),r.ready_modules[e.data]="ready",void(Object.size(r.ready_modules)==Object.size(t)&&(n.ready=!0,this.log("app ready")))):"module_not_ready"==e.type?(delete r.ready_modules[e.data],void(n.ready=!1)):(o.check(),void o.execute(e))},this.log=function(e){o.check(),window.console.log(e)},this.register_module=function(e){if("string"!=typeof e)return void o.error("Unable to add module "+e);if("undefined"==typeof App.modules[e])return void o.error("Error: Module not found.");var r=new App.modules[e](this),n={init:"function",functions:"object"};for(var a in n)if(typeof r[a]==typeof n[a])return void o.error("Unable to add module "+e+". "+a+" not found or malformed.");t[e]=r},this.repeater=function(e){("undefined"==typeof e||"undefined"==typeof e.template||"undefined"==typeof e.parent)&&o.error("Error: unable to initialize repeater. Check your parameters."),null==document.getElementById(e.template)&&o.error("Error: template not found.");var t={template:document.getElementById(e.template).children[0],parent:document.getElementById(e.parent),elements:[],repeater_id:n.repeater_id++,repeater_element_id:0};null==t.template&&o.error("Error: template not found."),("undefined"==typeof t.template||1!=t.template.parentNode.childElementCount)&&o.error("Error: template doesn't contain only one child."),null==t.parent&&o.error("Error: parent not found."),this.addData=function(e,r){o.check(),"object"!=typeof e&&o.error("Error: parameter is not an object."),("undefined"!=typeof e.repeater_element_id||"undefined"!=typeof e.app)&&o.error("Error: use of reserved data (repeater_element_id, app)"),0==o.check_replace_params(e)&&o.error("Error: parameters are not right."),e["data-repeater_element_id"]=t.repeater_element_id++,e["data-app"]=n.name;var a=o.repeater_create_object(t.template,e);return t.elements.push(a),r===!0?a:void t.parent.appendChild(a)},this.removeData=function(e){if(o.check(),"number"==typeof e||"string"==typeof e)for(var r=0;r<t.elements.length;r++){var n=t.elements[r];if(n.attributes["data-repeater_element_id"].value==e)return n.remove(),void t.elements.splice(r,1)}if("object"==typeof e)for(var r=0;r<t.elements.length;r++)if(t.elements[r].isSameNode(e))return t.elements[r].remove(),void t.elements.splice(r,1)}}}};